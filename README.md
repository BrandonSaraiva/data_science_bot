# Data Analysis Automation Project
This project aims to automate a large part of the data analysis process. Several libraries were used, including threading, time, pyautogui, keyboard, pygame, os, getpass, selenium, pandas, sqlite3, calendar and matplotlib.

# Step by step
The bot starts by grabbing the user's Chrome settings to access resources that require a login, such as Jupyter Notebook. Then it opens two tabs. One accesses the website https://peach.self.team/ to generate slides based on the information provided, while the other tab downloads the database, creates a dataframe and creates graphs.

In the slides section, information such as the title of the slide, the information it should contain and its objective is provided. In the other tab, the bot accesses the website https://asloterias.com.br/download-todos-resultados-lotofacil, scrolls until it finds the .csv file download button and, during this process, an audio is played explaining every step of what is being done.

After downloading the csv, the bot opens a notebook in Google Colab and types the necessary code using the keyboard.write library. The user must enter the csv file path in the code to create a dataframe with the pandas library. Then, the bot creates a database using the sqlite3 library.

From there, the bot analyzes the data and creates graphs. The first graph shows the 15 balls that dropped the most in the history of Lotofácil. To create this chart, the bot runs the following code:

```
sql_query = f'''
SELECT ball, COUNT(ball) as count
FROM (SELECT Bola_1 as ball FROM {table_name} UNION ALL
SELECT Bola_2 as ball FROM {table_name} UNION ALL
SELECT Bola_3 as ball FROM {table_name} UNION ALL
SELECT Bola_4 as ball FROM {table_name} UNION ALL
SELECT Bola_5 as ball FROM {table_name} UNION ALL
SELECT Bola_6 as ball FROM {table_name} UNION ALL
SELECT Bola_7 as ball FROM {table_name} UNION ALL
SELECT Bola_8 as ball FROM {table_name} UNION ALL
SELECT Bola_9 as ball FROM {table_name} UNION ALL
SELECT Bola_10 as ball FROM {table_name} UNION ALL
SELECT Bola_11 as ball FROM {table_name} UNION ALL
SELECT Bola_12 as ball FROM {table_name} UNION ALL
SELECT Bola_13 as ball FROM {table_name} UNION ALL
SELECT Bola_14 as ball FROM {table_name} UNION ALL
SELECT Bola_15 as ball FROM {table_name})

GROUP BY ball
ORDER BY count DESC
LIMIT 15
'''

result = conn.execute(sql_query).fetchall()

fig, ax = plt.subplots(figsize=(12, 5))

# Sets y-axis labels to "Ball 1", "Ball 2", etc.
y_labels = [f"Ball {row[0]}" for row in result][::-1]

# Sets the x-axis values to the counts of each ball
x_values = [row[1] for row in result][::-1]

# Set the colors of each bar as a list of RGBA tuples
bar_colors = [(0, 0, 1, i/18 + 0.2) for i in range(15)]

# Plot the horizontal bar chart
ax.barh(y_labels, x_values, color=bar_colors)


ax.set_xlabel('Number of times left')
ax.set_ylabel('Ball number')
ax.set_title('Top 15 balls that came out the most in the history of LotoFácil')

# Remove white space in the chart
plt.tight_layout()
```

The graph it generates:


![image](https://github.com/BrandonSaraiva/data_science_bot/assets/90096835/d4244f45-b7a0-4afa-ba37-d1561e37cb74)

After that, it will create a code that shows the 3 balls that come out the most each month, the result is this:

![image](https://github.com/BrandonSaraiva/data_science_bot/assets/90096835/18cdfd1a-fdce-4241-96e0-2f2f2efd7d51)

And finally, it produces a code that takes the current day, and then sees which balls dropped the most on that same day in the past, returning the result:

![image](https://github.com/BrandonSaraiva/data_science_bot/assets/90096835/446b1585-d5d0-4618-8fba-3db70a5a4e6f)

Remembering that throughout this process he is narrating the actions.

I added a function that when you press P it stops the code, in case something goes wrong in the process.

**Slides**

After pressing "Esc", the browser will close and a new tab will open, where the slide will be ready to be downloaded. When you press the right arrow, the commands to download, open and run the slide will be executed automatically. In the audio, it is explained that the AI responsible for generating the slides is still "learning" and that this is a free version. As a result, slides may not be of excellent quality and text formatting may be quite simple. Additionally, images that are not related to the content and curious and irrelevant information can be added. Previously, this project used the paid Google extension called Slides.Ai.io, which produced amazing slides. Unfortunately, due to the fact that it is a paid tool, it was not possible to continue using it.

**Presentation**

After the slides are generated by the bot, it is my responsibility to present them and provide additional information about the lotofácil lottery.

# Conclusion

This project can be optimized in several ways to make it more adaptable to other applications.

# Video

https://www.youtube.com/watch?v=OkfbAzvuI5o&t=58s
